<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="PyPi,自动化测试,Splinter," />










<meta name="description" content="使用 Splinter 做自动化测试.">
<meta name="keywords" content="PyPi,自动化测试,Splinter">
<meta property="og:type" content="article">
<meta property="og:title" content="自动化测试 Splinter">
<meta property="og:url" content="http://pyfdtic.github.io/2018/03/15/自动化测试-splinter/index.html">
<meta property="og:site_name" content="Pyfdtic&#39;s Blog">
<meta property="og:description" content="使用 Splinter 做自动化测试.">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-07-13T04:00:29.180Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="自动化测试 Splinter">
<meta name="twitter:description" content="使用 Splinter 做自动化测试.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://pyfdtic.github.io/2018/03/15/自动化测试-splinter/"/>





  <title>自动化测试 Splinter | Pyfdtic's Blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-115793075-1', 'auto');
  ga('send', 'pageview');
</script>





</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Pyfdtic's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">但行好事, 莫问前程.</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pyfdtic.github.io/2018/03/15/自动化测试-splinter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pyfdtic">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Pyfdtic's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">自动化测试 Splinter</h2>
        

        <div class="post-meta">
	  
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-15T15:39:53+08:00">
                2018-03-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>使用 Splinter 做自动化测试.<br><a id="more"></a><br><a href="http://splinter.readthedocs.io/en/latest/#get-in-touch-and-contribute" target="_blank" rel="noopener">Splinter Doc</a></p>
<p>Splinter是一个使用Python开发的开源Web应用测试工具，它可以帮你实现自动浏览站点和与其进行交互。</p>
<p>Splinter 是一个基于 Selenium, PhantomJS, zope.testbrowser 等已存在浏览器的抽象层度较高的自动化测试工具.</p>
<h2 id="1-特点"><a href="#1-特点" class="headerlink" title="1. 特点"></a>1. 特点</h2><ol>
<li>API 简单</li>
<li><p>多浏览器支持, 支持的 浏览器列表如下:</p>
<p> chrome webdriver,<br> firefox webdriver,<br> phantomjs webdriver,<br> zopetestbrowser,<br> remote webdriver</p>
</li>
<li><p>支持 CSS 选择器和 Xpath 选择器</p>
</li>
<li>支持 iframe 和 alert</li>
<li>支持执行 JavaScript</li>
<li>支持 ajax 调用和 async JavaScript</li>
</ol>
<h2 id="2-入门"><a href="#2-入门" class="headerlink" title="2. 入门"></a>2. 入门</h2><h3 id="2-1-安装"><a href="#2-1-安装" class="headerlink" title="2.1 安装"></a>2.1 安装</h3><ol>
<li><p>安装 python</p>
<p> 支持 Python 2.7+ 版本</p>
</li>
<li><p>安装 splinter</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install splinter</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装浏览器驱动:</p>
<p> 以 chrome 为例:</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://chromedriver.storage.googleapis.com/index.html?path=2.35/</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-2-示例"><a href="#2-2-示例" class="headerlink" title="2.2 示例:"></a>2.2 示例:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from splinter import Browser</span><br><span class="line"></span><br><span class="line"># 初始化 browser</span><br><span class="line">browser = Browser()</span><br><span class="line"></span><br><span class="line"># 打开首页</span><br><span class="line">browser.visit(&apos;http://google.com&apos;)</span><br><span class="line"></span><br><span class="line">browser.fill(&apos;q&apos;, &apos;splinter - python acceptance testing for web applications&apos;)</span><br><span class="line">browser.find_by_name(&apos;btnG&apos;).click()</span><br><span class="line"></span><br><span class="line">if browser.is_text_present(&apos;splinter.readthedocs.io&apos;):</span><br><span class="line">    print &quot;Yes, the official website was found!&quot;</span><br><span class="line">else:</span><br><span class="line">    print &quot;No, it wasn&apos;t found... We need to improve our SEO techniques&quot;</span><br><span class="line"></span><br><span class="line">browser.quit()</span><br></pre></td></tr></table></figure>
<p>Browser 对象支持 上下文管理:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">with Browser() as browser:</span><br><span class="line">    # code here</span><br></pre></td></tr></table></figure></p>
<h2 id="3-基础浏览器行为和交互"><a href="#3-基础浏览器行为和交互" class="headerlink" title="3. 基础浏览器行为和交互"></a>3. 基础浏览器行为和交互</h2><h3 id="3-1-网页对象"><a href="#3-1-网页对象" class="headerlink" title="3.1 网页对象"></a>3.1 网页对象</h3><ol>
<li><p>Browser 对象初始化</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">browser = Browser(&apos;chrome&apos;)</span><br><span class="line">browser = Browser(&apos;firefox&apos;)</span><br><span class="line">browser = Browser(&apos;zope.testbrowser&apos;)</span><br><span class="line"></span><br><span class="line">browser = Browser(driver_name=&quot;chrome&quot;, </span><br><span class="line">        executable_path=&quot;/path/to/chrome&quot;, </span><br><span class="line">        user_agent=&quot;Mozilla/5.0 (iPhone; U; CPU like Mac OS X; en)&quot;, </span><br><span class="line">        incognito=True)</span><br></pre></td></tr></table></figure>
</li>
<li><p>浏览网页</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">browser.visit(&apos;http://cobrateam.info&apos;)</span><br><span class="line">browser.visit(&apos;http://username:password@cobrateam.info/protected&apos;)    # basic HTTP 认证</span><br></pre></td></tr></table></figure>
</li>
<li><p>重载网页</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser.reload()</span><br></pre></td></tr></table></figure>
</li>
<li><p>You can back and forward on your browsing history using <code>back</code> and <code>forward</code> methods:</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">browser.visit(&apos;http://cobrateam.info&apos;)</span><br><span class="line">browser.visit(&apos;https://splinter.readthedocs.io&apos;)</span><br><span class="line">browser.back()</span><br><span class="line">browser.forward()</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取当前网页的相关内容</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">browser.title   # 网页标题</span><br><span class="line">browser.html    # 网页的 html 代码</span><br><span class="line">browser.url     # 网页的 url</span><br></pre></td></tr></table></figure>
</li>
<li><p>管理多个窗口, 使用 <code>windows</code> 对象, 例如弹出窗口.</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">browser.windows              # all open windows</span><br><span class="line">browser.windows[0]           # the first window</span><br><span class="line">browser.windows[window_name] # the window_name window</span><br><span class="line">browser.windows.current      # the current window</span><br><span class="line">browser.windows.current = browser.windows[3]  # set current window to window 3</span><br><span class="line"></span><br><span class="line">window = browser.windows[0]</span><br><span class="line">window.is_current            # boolean - whether window is current active window</span><br><span class="line">window.is_current = True     # set this window to be current window</span><br><span class="line">window.next                  # the next window</span><br><span class="line">window.prev                  # the previous window</span><br><span class="line">window.close()               # close this window</span><br><span class="line">window.close_others()        # close all windows except this one</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="3-2-查找网页元素"><a href="#3-2-查找网页元素" class="headerlink" title="3.2 查找网页元素"></a>3.2 查找网页元素</h3><ol>
<li><p>网页元素获取</p>
<p> splinter 支持 6 种元素查找方式, 每种方式均返回列表作为查找结果.</p>
<p> 支持 <code>first</code>, <code>last</code> 快捷方式, 查找第一个和最后一个元素.</p>
<p> 因为每个页面中, id 的值一般是不重复的, 因此 <code>find_by_id</code> 总是返回<strong>只有一个元素的列表</strong>.</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">browser.find_by_css(&apos;h1&apos;)</span><br><span class="line">browser.find_by_xpath(&apos;//h1&apos;)</span><br><span class="line">browser.find_by_tag(&apos;h1&apos;)</span><br><span class="line">browser.find_by_name(&apos;name&apos;)</span><br><span class="line">browser.find_by_text(&apos;Hello World!&apos;)</span><br><span class="line">browser.find_by_id(&apos;firstheader&apos;)</span><br><span class="line">browser.find_by_value(&apos;query&apos;)</span><br><span class="line"></span><br><span class="line">browser.find_by_xpath(&apos;//h1&apos;).first</span><br><span class="line">browser.find_by_name(&apos;name&apos;).last</span><br><span class="line">browser.find_by_tag(&apos;h1&apos;)[1]</span><br></pre></td></tr></table></figure>
<p> 获取元素的值</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser.find_by_css(&apos;h1&apos;).first.value</span><br></pre></td></tr></table></figure>
</li>
<li><p>查找 URL </p>
<p> 返回<strong>列表</strong>作为结果.</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">links_found = browser.find_link_by_text(&apos;Link for Example.com&apos;)</span><br><span class="line">links_found = browser.find_link_by_partial_text(&apos;for Example&apos;)</span><br><span class="line">links_found = browser.find_link_by_href(&apos;http://example.com&apos;)</span><br><span class="line">links_found = browser.find_link_by_partial_href(&apos;example&apos;)</span><br></pre></td></tr></table></figure>
<p> Clicking links : These methods return the first element always.</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 绝对 url</span><br><span class="line">browser.click_link_by_href(&apos;http://www.the_site.com/my_link&apos;)</span><br><span class="line"></span><br><span class="line"># 相对 url</span><br><span class="line">browser.click_link_by_partial_href(&apos;my_link&apos;)</span><br><span class="line"></span><br><span class="line">browser.click_link_by_text(&apos;my link&apos;)</span><br><span class="line">browser.click_link_by_partial_text(&apos;part of link text&apos;)</span><br><span class="line"></span><br><span class="line">browser.click_link_by_id(&apos;link_id&apos;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>链式查找</p>
<p> Finding method are chainable, so you can find the descendants of a previously found element.</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">divs = browser.find_by_tag(&quot;div&quot;)</span><br><span class="line">within_elements = divs.first.find_by_name(&quot;name&quot;)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>ElementDoesNotExist</code> 异常</p>
<p> If an element is not found, the <code>find_*</code> methods return an empty list. </p>
<p> But if you try to access an element in this list, the method will raise the <code>splinter.exceptions.ElementDoesNotExist</code> exception.</p>
</li>
</ol>
<ol>
<li><p>Clicking buttons</p>
<p> You can click in buttons. Splinter follows any redirects, and submits forms associated with buttons.</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">browser.find_by_name(&apos;send&apos;).first.click()</span><br><span class="line"></span><br><span class="line">browser.find_link_by_text(&apos;my link&apos;).first.click()</span><br></pre></td></tr></table></figure>
</li>
<li><p>表单</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">browser.fill(&apos;query&apos;, &apos;my name&apos;)</span><br><span class="line">browser.attach_file(&apos;file&apos;, &apos;/path/to/file/somefile.jpg&apos;)</span><br><span class="line">browser.choose(&apos;some-radio&apos;, &apos;radio-value&apos;)</span><br><span class="line">browser.check(&apos;some-check&apos;)</span><br><span class="line">browser.uncheck(&apos;some-check&apos;)</span><br><span class="line">browser.select(&apos;uf&apos;, &apos;rj&apos;)</span><br></pre></td></tr></table></figure>
<p> To trigger JavaScript events, like KeyDown or KeyUp, you can use the <code>type</code> method.</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser.type(&quot;type&quot;, &quot;typing text&quot;)</span><br></pre></td></tr></table></figure>
<p> If you pass the argument <code>slowly=True</code> to the <code>type</code> method you can interact with the page on every key pressed. Useful for test field’s autocompletion (The browser will wait until next iteration to type the subsequent key).</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">for key in browser.type(&quot;type&quot;, &quot;typing slowly&quot;, slowly=True):</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure>
<p> You can also use <code>type</code> and <code>fill</code> methods in an element.</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">browser.find_by_name(&quot;name&quot;).type(&quot;Steve Jobs&quot;, slowly=True)</span><br><span class="line">browser.find_by_css(&quot;.city&quot;).fill(&quot;San Francisco&quot;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>判断元素是否可见.</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 返回布尔值</span><br><span class="line">browser.find_by_css(&apos;h1&apos;).first.visible</span><br></pre></td></tr></table></figure>
</li>
<li><p>判断元素是否有 <code>className</code></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 返回布尔值</span><br><span class="line">browser.find_by_css(&apos;.content&apos;).first.has_class(&apos;content&apos;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Interacting with elements through a ElementList object</p>
<p> You can invoke any <code>Element</code> method on <code>ElementList</code> and it will be proxied to the <strong>first</strong> element of the list. So the two lines below are quivalent.</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">assert browser.find_by_css(&apos;a.banner&apos;).first.visible</span><br><span class="line">assert browser.find_by_css(&apos;a.banner&apos;).visible</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="3-3-鼠标"><a href="#3-3-鼠标" class="headerlink" title="3.3 鼠标"></a>3.3 鼠标</h3><p><strong>大多数鼠标事件目前只支持 Chrome 和 Firefox 27.0.1</strong></p>
<p>支持 mouse_over, mouse_out,单击, 双击, 右击鼠标.</p>
<ol>
<li><p><code>mouse_over</code> : puts the mouse above the element.</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser.find_by_tag(&apos;h1&apos;).mouse_over()</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>mouns_out</code> : puts the mouse out of the element.</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser.find_by_tag(&apos;h1&apos;).mouse_out()</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>click</code> : 单击</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser.find_by_tag(&apos;h1&apos;).click()</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>double_click</code> : 双击</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser.find_by_tag(&apos;h1&apos;).double_click()</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>right_click</code> : 右击</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser.find_by_tag(&apos;h1&apos;).right_click()</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>drag_and_drop</code> : You can drag an element and drop it to another element.</p>
<p> The example below drags the <code>&lt;h1&gt; ... &lt;/h1&gt;</code> element and drop it to a container element (identified by a CSS class).</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">draggable = browser.find_by_tag(&apos;h1&apos;)</span><br><span class="line">target = browser.find_by_css(&apos;.container&apos;)</span><br><span class="line">draggable.drag_and_drop(target)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="3-4-Ajax-amp-Async-JavaScript"><a href="#3-4-Ajax-amp-Async-JavaScript" class="headerlink" title="3.4 Ajax &amp; Async JavaScript"></a>3.4 Ajax &amp; Async JavaScript</h3><p>When working with Ajax and Asynchronous JavaScript, it’s common to have elements which are not present in the HTML code(they are created with JavaScript, dynamically). In this case, you can use the methods <code>is_element_present</code> and <code>is_text_present</code> to check the existence of an element or text – Splinter will load the HTML and JavaScript in the browser and the check will be performed <em>before</em> processing JavaScript.</p>
<p>There is also the optional argument <code>wait_time</code> (given in seconds), it’s a timeout: if the verification method gets <code>True</code> it will return the result (even if the <code>wait_time</code> is not over); if it doesn’t get <code>True</code>, the method will wait until the <code>wait_time</code> is over (sp it’ll return the result).<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 检查文本是否 存在</span><br><span class="line">browser = Browser()</span><br><span class="line">browser.visit(&apos;https://splinter.readthedocs.io/&apos;)</span><br><span class="line">browser.is_text_present(&apos;splinter&apos;) # True</span><br><span class="line">browser.is_text_present(&apos;splinter&apos;, wait_time=10) # True, using wait_time</span><br><span class="line">browser.is_text_present(&apos;text not present&apos;) # False</span><br><span class="line"></span><br><span class="line"># 检查文本是否 不存在</span><br><span class="line">browser.is_text_not_present(&apos;text not present&apos;) # True</span><br><span class="line">browser.is_text_not_present(&apos;text not present&apos;, wait_time=10) # True, using wait_time</span><br><span class="line">browser.is_text_not_present(&apos;splinter&apos;) # False</span><br></pre></td></tr></table></figure></p>
<p><strong>元素(element)存在性检查</strong>, 返回<em>布尔值</em>.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 检查元素是否 存在</span><br><span class="line">browser.is_element_present_by_css(&apos;h1&apos;)</span><br><span class="line">browser.is_element_present_by_xpath(&apos;//h1&apos;)</span><br><span class="line">browser.is_element_present_by_tag(&apos;h1&apos;)</span><br><span class="line">browser.is_element_present_by_name(&apos;name&apos;)</span><br><span class="line">browser.is_element_present_by_text(&apos;Hello World!&apos;)</span><br><span class="line">browser.is_element_present_by_id(&apos;firstheader&apos;)</span><br><span class="line">browser.is_element_present_by_value(&apos;query&apos;)</span><br><span class="line">browser.is_element_present_by_value(&apos;query&apos;, wait_time=10) # using wait_time</span><br><span class="line"></span><br><span class="line"># 检查元素是否 不存在</span><br><span class="line">browser.is_element_not_present_by_css(&apos;h6&apos;)</span><br><span class="line">browser.is_element_not_present_by_xpath(&apos;//h6&apos;)</span><br><span class="line">browser.is_element_not_present_by_tag(&apos;h6&apos;)</span><br><span class="line">browser.is_element_not_present_by_name(&apos;unexisting-name&apos;)</span><br><span class="line">browser.is_element_not_present_by_text(&apos;Not here :(&apos;)</span><br><span class="line">browser.is_element_not_present_by_id(&apos;unexisting-header&apos;)</span><br><span class="line">browser.is_element_not_present_by_id(&apos;unexisting-header&apos;, wait_time=10) # using wait_time</span><br></pre></td></tr></table></figure></p>
<h3 id="3-5-cookie-管理"><a href="#3-5-cookie-管理" class="headerlink" title="3.5 cookie 管理"></a>3.5 cookie 管理</h3><p>It is possible to manipulate cookies using the <code>cookies</code> attribute from a <code>Browser</code> instance. The <code>cookies</code> attribute is a instance of a <code>CookieManager</code> class that manipulates cookies, like adding and deleting them.</p>
<ol>
<li><p>添加 cookies</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser.cookies.add(&#123;&quot;key&quot;: &quot;value&quot;&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>检索 cookies</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">        browser.cookies.all()</span><br><span class="line">    ```   </span><br><span class="line">3. 删除 cookies</span><br><span class="line">    </span><br><span class="line">    删除 **单个 cookies**</span><br></pre></td></tr></table></figure>
<pre><code>browser.cookies.delete(&quot;key1&quot;)      # 删除 单个 cookies
browser.cookies.delete(&quot;key1&quot;, &quot;key2&quot;)  # 删除 两个 cookies
</code></pre> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">删除 **所有 cookies**</span><br></pre></td></tr></table></figure>
<pre><code>browser.cookies.delete()
</code></pre> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">## 4. JavaScript 支持</span><br><span class="line"></span><br><span class="line">You can easily execute JavaScript in drivers which support it.</span><br></pre></td></tr></table></figure>
<p> browser.execute_script(“$(‘body’).empty()”)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">You can return the result of the script.</span><br><span class="line">``` </span><br><span class="line">    browser.evaluate_script(&quot;4+4&quot;) == 8</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="5-其他"><a href="#5-其他" class="headerlink" title="5. 其他"></a>5. 其他</h2><h3 id="5-1-HTTP-响应码处理及异常处理"><a href="#5-1-HTTP-响应码处理及异常处理" class="headerlink" title="5.1 HTTP 响应码处理及异常处理"></a>5.1 HTTP 响应码处理及异常处理</h3><p><strong><code>status_code</code> and this HTTP exception handling is available only for selenium webdriver</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">browser.visit(&quot;http://www.baidu.com&quot;)</span><br><span class="line">browser.status_code.is_success()    # True</span><br><span class="line">browser.status_code == 200      # True</span><br><span class="line">browser.status_code.code        # 200</span><br></pre></td></tr></table></figure></p>
<p>当网页返回失败时, 触发 <code>HttpResponseError</code> 错误.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">try:</span><br><span class="line">    browser.visit(&apos;http://cobrateam.info/i-want-cookies&apos;)</span><br><span class="line">except HttpResponseError, e:</span><br><span class="line">    print &quot;Oops, I failed with the status code %s and reason %s&quot; % (e.status_code, e.reason)</span><br></pre></td></tr></table></figure></p>
<h3 id="5-2-iframers"><a href="#5-2-iframers" class="headerlink" title="5.2 iframers"></a>5.2 iframers</h3><p>You can use the <code>get_iframe</code> method and the <code>with</code> statement to interact with iframe.</p>
<p>You can pass the iframe’s name, id, or index to <code>get_iframe</code>.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">with browser.get_iframe(&apos;iframemodal&apos;) as iframe:</span><br><span class="line">    iframe.do_stuff()</span><br></pre></td></tr></table></figure></p>
<h3 id="5-3-alert-and-prompts"><a href="#5-3-alert-and-prompts" class="headerlink" title="5.3 alert and prompts"></a>5.3 alert and prompts</h3><p><strong>Only webdrivers (Firefox and Chrome) has support for alerts and prompts</strong></p>
<p>You can deal with alerts and prompts using the <code>get_alert</code> method.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">alert = browser.get_alert()</span><br><span class="line">alert.text</span><br><span class="line">alert.accept()</span><br><span class="line">alert.dismiss()</span><br></pre></td></tr></table></figure></p>
<p>In case of prompts, you can answer it using the <code>fill_with</code> method.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">prompts = browser.get_alert()</span><br><span class="line">prompts.text</span><br><span class="line">prompts.fill_with(&quot;text&quot;)</span><br><span class="line">prompts.accept()</span><br><span class="line">prompts.dismiss()</span><br></pre></td></tr></table></figure></p>
<p>You can use the <code>with</code> statement to interacte with both alerts and prompts too.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">with browser.get_alert() as alert:</span><br><span class="line">    alert.do_stuff()</span><br></pre></td></tr></table></figure></p>
<p><strong>IMPORTANT</strong> : if there’s not any prompt or alert, <code>get_alert</code> will return <code>None</code>. Remember to always use at least one of the alert/prompt ending methods(accept/dismiss). Otherwise your browser instance will be frozen until you accept or dismiss the alert/prompt correctly.</p>
<h2 id="6-Drivers"><a href="#6-Drivers" class="headerlink" title="6. Drivers"></a>6. Drivers</h2><h3 id="6-1-Chrome"><a href="#6-1-Chrome" class="headerlink" title="6.1 Chrome"></a>6.1 Chrome</h3><ol>
<li><p>安装</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 依赖 Selenium </span><br><span class="line">$ pip install selenium</span><br><span class="line"></span><br><span class="line"># 需要安装 chrome 浏览器</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用</p>
<ul>
<li><p>headless option for Chrome</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser = Browser(&quot;chrome&quot;, headless=True)</span><br></pre></td></tr></table></figure>
</li>
<li><p>incognito option: 隐身模式</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser = Browser(&quot;chrome&quot;, incognito=True)</span><br></pre></td></tr></table></figure>
</li>
<li><p>emulation option: 仿真模式</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from selenium import webdriver</span><br><span class="line">from splinter import Browser</span><br><span class="line"></span><br><span class="line">mobile_enulation = &#123;&quot;driverName&quot;: &quot;Google Nexus 5&quot;&#125;</span><br><span class="line">chrome_options = webdriver.ChromeOptions()</span><br><span class="line">chrome_options.add_experimental_option(&quot;mobileEmulation&quot;, mobile_enulation)</span><br><span class="line">browser = Browser(&quot;chrome&quot;, options=chrome_options)</span><br></pre></td></tr></table></figure>
</li>
<li><p>screenshot:</p>
<p>  Take a screenshot of the current page and saves it locally.</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">screenshot(name=None, suffix=&apos;.png&apos;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/PyPi/" rel="tag"># PyPi</a>
          
            <a href="/tags/自动化测试/" rel="tag"># 自动化测试</a>
          
            <a href="/tags/Splinter/" rel="tag"># Splinter</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/03/15/fake-useragent-文档/" rel="next" title="fake-useragent-文档">
                <i class="fa fa-chevron-left"></i> fake-useragent-文档
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/03/15/Ansible-Inventory/" rel="prev" title="Ansible-Inventory">
                Ansible-Inventory <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Pyfdtic</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">115</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">97</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/pyfdtic" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-特点"><span class="nav-text">1. 特点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-入门"><span class="nav-text">2. 入门</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-安装"><span class="nav-text">2.1 安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-示例"><span class="nav-text">2.2 示例:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-基础浏览器行为和交互"><span class="nav-text">3. 基础浏览器行为和交互</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-网页对象"><span class="nav-text">3.1 网页对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-查找网页元素"><span class="nav-text">3.2 查找网页元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-鼠标"><span class="nav-text">3.3 鼠标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-Ajax-amp-Async-JavaScript"><span class="nav-text">3.4 Ajax &amp; Async JavaScript</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-cookie-管理"><span class="nav-text">3.5 cookie 管理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-其他"><span class="nav-text">5. 其他</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-HTTP-响应码处理及异常处理"><span class="nav-text">5.1 HTTP 响应码处理及异常处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-iframers"><span class="nav-text">5.2 iframers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-alert-and-prompts"><span class="nav-text">5.3 alert and prompts</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-Drivers"><span class="nav-text">6. Drivers</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-Chrome"><span class="nav-text">6.1 Chrome</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Pyfdtic</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('-1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
